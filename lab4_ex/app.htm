<!DOCTYPE html>           
<html>
<head>
    <title></title>
    <meta charset="utf-8" />
    <script type="text/javascript" src="globals.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.7.1/firebase.js"></script>
    <script type="text/javascript" src="dataBaseApi.js"></script>
    <link href="inc/bootstrap.min.css" rel="stylesheet" />
    <script src="inc/jquery-3.2.1.min.js"></script>
    <link href="inc/bootstrap.css" rel="stylesheet" /><!--alex-->
    <!--  <link href="inc/bootstrap.js" rel="stylesheet" />-->
    <script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script> <!--pie graph-->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.css">
    <script src="//code.jquery.com/jquery.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.js"></script>
    <link href="inc/bootstrap.css" rel="stylesheet" /><!--alex-->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.8.0/dist/JsBarcode.all.min.js"></script>

    <style>
        h2 {
            color: white;
        }
    </style>
    <script>
        $(function () {
            // on document ready
            ResetUser();
            ShowPage(1);
        });

        function ResetUser() {
            activeUser = {
                mail: "",
                user: "",
                pass: ""
            };
            $("input").val("");
        }

        function Register() {
            activeUser = {
                mail: $("#inpMail").val(),
                user: $("#inpUser").val(),
                pass: $("#inpPassword").val()
            }
            localStorage[activeUser.user] = JSON.stringify(activeUser);
            ShowPage(2);
        }

        async function Login() {
            var u = {
                user: $("#inpUser1").val(),
                pass: $("#inpPassword1").val()
            }
            var passwordFromDB = await getPassword(u.user);
            if (passwordFromDB == undefined) {
                ShowPage(3);
            } else {
                if (passwordFromDB == u.pass) {
                    u.type = await getUserType(u.user);
                    u.mail = await getEmail(u.user);
                    activeUser = u;

                    if (u.type == "driver") {
                        activeDriver = await getDriver(activeUser.user);
                        $("#container").load("user.html");
                    } else if (u.type == "admin") {
                        $("#container").load("adminPage.html");
                    }

                } else {
                    ShowPage(1);
                    window.alert("wrong password!");
                }
            }
        }
    </script>
</head>

<body>
    <div id ="container" class="container">
        <!--logo:-->
        <img src="logoParkIT.png" alt="logo" style=" border: none; padding: 12px 16px; cursor: pointer;
         position: absolute; bottom: 0px; right: 30px;">
        <div style="width: 500px; margin: 30px auto">
            <!--page  registration n=0-->
            <div class="page" data-ttl="Registration Form">
                <form>
                    <fieldset>
                        <div class="form-group">
                            <label for="inpMail">Email address</label>
                            <input type="email" class="form-control" id="inpMail" placeholder="Enter email">
                        </div>
                        <div class="form-group">
                            <label for="inpUser">Username</label>
                            <input type="text" class="form-control" id="inpUser" placeholder="Enter username">
                        </div>
                        <div class="form-group">
                            <label for="inpPassword">Password</label>
                            <input type="password" class="form-control" id="inpPassword" placeholder="Enter password">
                        </div>
                        <div>
                            <button type="button" class="btn btn-primary" onclick="Register()">Submit</button>
                        </div>
                    </fieldset>

                </form>
            </div>

            <!--page login n=1 -->
            <div class="page" data-ttl="Login Form">
                <form>
                    <fieldset>
                        <div class="form-group">
                            <label for="inpUser1">Username</label>
                            <input type="text" class="form-control" id="inpUser1" placeholder="Enter username">
                        </div>
                        <div class="form-group">
                            <label for="inpPassword1">Password</label>
                            <input type="password" class="form-control" id="inpPassword1" placeholder="Enter password">
                        </div>
                        <div>
                            <button type="button" class="btn btn-primary" onclick="Login()">Submit</button>
                        </div>
                    </fieldset>

                </form>
            </div>

            <!--page welcome page n=2 -->
            <div class="alert alert-info page" data-ttl="Welcome Page">
                <p>Welcome <strong id="userName"></strong> !</p>
            </div>

            <!--page error login n=3 -->
            <div class="alert alert-warning page" data-ttl="Error Login">
                <strong>Error login!</strong>
            </div>

            <!--buttons of one page appw'-->
            <div>
                <a id="aReg" href="#" onclick="ShowPage(0)">Registration form</a><br />
                <a id="aLogin" href="#" onclick="ShowPage(1)">Login</a><br />
                <a id="aLogout" href="#" onclick="ShowPage(1); ResetUser();">Logout</a><br />

            </div>
        </div>
    </div>
</body>
</html>
